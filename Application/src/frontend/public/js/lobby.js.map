{"version":3,"file":"lobby.js","sources":["../../lobby/load-games.ts","../../lobby.ts"],"sourcesContent":["import { Game } from \"../../types/types\";\r\n\r\nconst gameListing = document.querySelector<HTMLDivElement>(\"#game-list\")!;\r\nconst gameItemTemplate = document.querySelector<HTMLTemplateElement>(\"#game-listing-template\")!;\r\n\r\nexport const loadGames = () => {\r\n  fetch(\"/games\", { credentials: \"include\" });\r\n};\r\n\r\nconst createGameElement = (game: Game) => {\r\n  const gameItem = gameItemTemplate.content.cloneNode(true) as HTMLDivElement;\r\n\r\n  gameItem.querySelector(\".game-id\")!.textContent = `${game.id}`;\r\n  gameItem.querySelector(\".game-name\")!.textContent = game.name ?? `Game ${game.id}`;\r\n  gameItem.querySelector(\".game-created-by\")!.textContent = `${game.created_by}`;\r\n  gameItem.querySelector(\".game-state\")!.textContent = game.state;\r\n  gameItem.querySelector(\".max-players\")!.textContent = `${game.max_players}`;\r\n  gameItem.querySelector(\".created-at\")!.textContent = new Date(\r\n    game.created_at,\r\n  ).toLocaleDateString();\r\n\r\n  const goToGameBtn = gameItem.querySelector(\".goto-game-btn\") as HTMLAnchorElement;\r\n  goToGameBtn.href = `/games/${game.id}`;\r\n\r\n  return gameItem;\r\n};\r\n\r\nexport const renderGames = (games: Game[]) => {\r\n  gameListing.replaceChildren(...games.map(createGameElement));\r\n};\r\n\r\nexport const appendGame = (game: Game) => {\r\n  gameListing.appendChild(createGameElement(game));\r\n};\r\n","import socketIo from \"socket.io-client\";\r\nimport * as EVENTS from \"../shared/keys\";\r\nimport type { Game } from \"../types/types\";\r\nimport { appendGame, loadGames, renderGames } from \"./lobby/load-games\";\r\n\r\nconst socket = socketIo();\r\n\r\nsocket.on(EVENTS.GAME_LISTING, (games: Game[]) => {\r\n  console.log(EVENTS.GAME_LISTING, games);\r\n\r\n  renderGames(games);\r\n});\r\n\r\nsocket.on(EVENTS.GAME_CREATE, (game: Game) => {\r\n  console.log(EVENTS.GAME_CREATE, game);\r\n\r\n  appendGame(game);\r\n});\r\n\r\n// Wait for socket connection before loading games to avoid race condition\r\nsocket.on(\"connect\", () => {\r\n  console.log(\"Socket connected, loading games...\");\r\n  loadGames();\r\n});\r\n"],"names":["gameListing","gameItemTemplate","loadGames","createGameElement","game","gameItem","goToGameBtn","renderGames","games","appendGame","socket","socketIo","EVENTS.GAME_LISTING","EVENTS.GAME_CREATE"],"mappings":"4DAEA,MAAMA,EAAc,SAAS,cAA8B,YAAY,EACjEC,EAAmB,SAAS,cAAmC,wBAAwB,EAEhFC,EAAY,IAAM,CAC7B,MAAM,SAAU,CAAE,YAAa,SAAA,CAAW,CAC5C,EAEMC,EAAqBC,GAAe,CACxC,MAAMC,EAAWJ,EAAiB,QAAQ,UAAU,EAAI,EAExDI,EAAS,cAAc,UAAU,EAAG,YAAc,GAAGD,EAAK,EAAE,GAC5DC,EAAS,cAAc,YAAY,EAAG,YAAcD,EAAK,MAAQ,QAAQA,EAAK,EAAE,GAChFC,EAAS,cAAc,kBAAkB,EAAG,YAAc,GAAGD,EAAK,UAAU,GAC5EC,EAAS,cAAc,aAAa,EAAG,YAAcD,EAAK,MAC1DC,EAAS,cAAc,cAAc,EAAG,YAAc,GAAGD,EAAK,WAAW,GACzEC,EAAS,cAAc,aAAa,EAAG,YAAc,IAAI,KACvDD,EAAK,UAAA,EACL,mBAAA,EAEF,MAAME,EAAcD,EAAS,cAAc,gBAAgB,EAC3D,OAAAC,EAAY,KAAO,UAAUF,EAAK,EAAE,GAE7BC,CACT,EAEaE,EAAeC,GAAkB,CAC5CR,EAAY,gBAAgB,GAAGQ,EAAM,IAAIL,CAAiB,CAAC,CAC7D,EAEaM,EAAcL,GAAe,CACxCJ,EAAY,YAAYG,EAAkBC,CAAI,CAAC,CACjD,EC5BMM,EAASC,EAAA,EAEfD,EAAO,GAAGE,EAAsBJ,GAAkB,CAChD,QAAQ,IAAII,EAAqBJ,CAAK,EAEtCD,EAAYC,CAAK,CACnB,CAAC,EAEDE,EAAO,GAAGG,EAAqBT,GAAe,CAC5C,QAAQ,IAAIS,EAAoBT,CAAI,EAEpCK,EAAWL,CAAI,CACjB,CAAC,EAGDM,EAAO,GAAG,UAAW,IAAM,CACzB,QAAQ,IAAI,oCAAoC,EAChDR,EAAA,CACF,CAAC"}